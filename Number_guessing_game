from flask import Flask, request, session, render_template_string, redirect, url_for
import random

app = Flask(__name__)
app.secret_key = 'your_secret_key'  # Required for session handling

# HTML template for the page
template = """
<!doctype html>
<title>Number Guessing Game</title>
<h2>Guess a number between 1 and 100</h2>
<form method="post">
    <input type="number" name="guess" min="1" max="100" required>
    <input type="submit" value="Submit Guess">
</form>
{% if message %}
    <h3>{{ message }}</h3>
{% endif %}
<form method="post">
    <button type="submit" name="reset" value="1">Restart Game</button>
</form>
"""

@app.route('/', methods=['GET', 'POST'])
def index():
    # Initialize secret number if not already set
    if 'number' not in session:
        session['number'] = random.randint(1, 100)
        session['attempts'] = 0
        print(f"[DEBUG] Secret number generated: {session['number']}")  # Show once at game start

    # Always show current secret number in the terminal
    print(f"[DEBUG] Current secret number: {session.get('number')}")

    message = ""

    if request.method == 'POST':
        if 'reset' in request.form:
            session.pop('number', None)
            session.pop('attempts', None)
            return redirect(url_for('index'))

        guess = int(request.form['guess'])
        session['attempts'] += 1
        secret = session['number']

        if guess < secret:
            message = "Too low! Try again."
        elif guess > secret:
            message = "Too high! Try again."
        else:
            message = f"ðŸŽ‰ Correct! You guessed it in {session['attempts']} attempts."
            session.pop('number', None)
            session.pop('attempts', None)

    return render_template_string(template, message=message)

if __name__ == '__main__':
    app.run(debug=True)

