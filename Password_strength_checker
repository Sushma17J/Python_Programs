from flask import Flask, request, render_template_string
import re

app = Flask(__name__)

# HTML template
template = """
<!doctype html>
<title>Password Strength Checker</title>
<h2>Check Your Password Strength🔏</h2>
<form method="post">
    <label>Enter password: <input type="password" name="password" required></label>
    <input type="submit" value="Check Strength">
</form>

{% if result %}
    <h3>{{ result }}</h3>
{% endif %}
"""

# Function to evaluate password strength
def evaluate_password_strength(password):
    score = 0
    feedback = []

    # Length check
    if len(password) >= 8:
        score += 1
    else:
        feedback.append("❌ Password should be at least 8 characters.")

    # Uppercase check
    if re.search(r'[A-Z]', password):
        score += 1
    else:
        feedback.append("❌ Include at least one uppercase letter.")

    # Lowercase check
    if re.search(r'[a-z]', password):
        score += 1
    else:
        feedback.append("❌ Include at least one lowercase letter.")

    # Digit check
    if re.search(r'\d', password):
        score += 1
    else:
        feedback.append("❌ Include at least one digit.")

    # Special character check
    if re.search(r'[!@#$%^&*(),.?":{}|<>]', password):
        score += 1
    else:
        feedback.append("❌ Include at least one special character.")

    # Final result
    if score == 5:
        return "✅ Strong password! 💪"
    elif 3 <= score < 5:
        return "⚠️ Moderate password: " + " ".join(feedback)
    else:
        return "❌ Weak password: " + " ".join(feedback)

@app.route('/', methods=['GET', 'POST'])
def check_password():
    result = None
    if request.method == 'POST':
        password = request.form['password']
        result = evaluate_password_strength(password)
    return render_template_string(template, result=result)

if __name__ == '__main__':
    app.run(debug=True)
