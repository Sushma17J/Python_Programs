from flask import Flask, request, render_template_string
import requests
from bs4 import BeautifulSoup

app = Flask(__name__)

# HTML Template
template = """
<!doctype html>
<title>Web Scraper</title>
<h2>Simple Web Scraper</h2>
<form method="POST">
    <label>Enter URL:</label><br>
    <input type="url" name="url" required placeholder="https://example.com"><br><br>
    
    <label>HTML Tag to Extract (e.g., h1, p, a):</label><br>
    <input type="text" name="tag" required placeholder="p"><br><br>
    
    <input type="submit" value="Scrape">
</form>

{% if results %}
    <h3>Results for &lt;{{ tag }}&gt; tags:</h3>
    <ul>
    {% for item in results %}
        <li>{{ item }}</li>
    {% endfor %}
    </ul>
{% elif error %}
    <p style="color: red;"><strong>Error:</strong> {{ error }}</p>
{% endif %}
"""

@app.route('/', methods=['GET', 'POST'])
def scrape():
    results = []
    error = ''
    tag = ''
    
    if request.method == 'POST':
        url = request.form['url']
        tag = request.form['tag']
        
        try:
            response = requests.get(url, timeout=10)
            response.raise_for_status()
            soup = BeautifulSoup(response.text, 'html.parser')
            elements = soup.find_all(tag)
            results = [element.get_text(strip=True) for element in elements if element.get_text(strip=True)]
        except Exception as e:
            error = str(e)
    
    return render_template_string(template, results=results, error=error, tag=tag)

if __name__ == '__main__':
    app.run(debug=True)
